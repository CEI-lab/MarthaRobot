<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>robot.thread_manager.ThreadManager &#8212; MarthaRobot  documentation</title>
    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/groundwork.css" />
    <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
    <script src="../../../_static/doctools.js"></script>
    <script src="../../../_static/sphinx_highlight.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../../index.html">MarthaRobot  documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../../index.html" accesskey="U">Module code</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">robot.thread_manager.ThreadManager</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <h1>Source code for robot.thread_manager.ThreadManager</h1><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">threading</span>
<span class="kn">import</span> <span class="nn">logging</span>
<span class="kn">import</span> <span class="nn">traceback</span>
<span class="kn">from</span> <span class="nn">threading</span> <span class="kn">import</span> <span class="n">Thread</span>
<span class="kn">import</span> <span class="nn">time</span>


<div class="viewcode-block" id="ThreadManager"><a class="viewcode-back" href="../../../_autosummary/robot.thread_manager.ThreadManager.ThreadManager.html#robot.thread_manager.ThreadManager.ThreadManager">[docs]</a><span class="k">class</span> <span class="nc">ThreadManager</span><span class="p">(</span><span class="n">threading</span><span class="o">.</span><span class="n">Thread</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    ThreadManager This class can be used to start new threads and log messages messages. It is important to note that in any code that</span>
<span class="sd">    leverages this thread manager should use the method &quot;logging.debug()&quot; instead of print. This allows messages to be</span>
<span class="sd">    displayed with thread and time info. (Legacy Code - Only manually tested and reviewed)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">_instance</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="fm">__new__</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Ensures only one instance of :class:`ThreadManager` is created.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">cls</span><span class="o">.</span><span class="n">_instance</span><span class="p">:</span>
            <span class="bp">cls</span><span class="o">.</span><span class="n">_instance</span> <span class="o">=</span> <span class="nb">super</span><span class="p">(</span><span class="n">ThreadManager</span><span class="p">,</span> <span class="bp">cls</span><span class="p">)</span><span class="o">.</span><span class="fm">__new__</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">_instance</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Constructor</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Call parent constructor</span>
        <span class="n">Thread</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">daemon</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;Thread Manager&quot;</span>

        <span class="c1"># Global variables for storing theads and thread counts</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">periodic_threads</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">onetime_threads</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">periodic_count</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">onetime_count</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">monitor_threads</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">monitor_debug_period</span> <span class="o">=</span> <span class="mf">3.0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">alive_count</span> <span class="o">=</span> <span class="mi">0</span>

<div class="viewcode-block" id="ThreadManager.run"><a class="viewcode-back" href="../../../_autosummary/robot.thread_manager.ThreadManager.ThreadManager.html#robot.thread_manager.ThreadManager.ThreadManager.run">[docs]</a>    <span class="k">def</span> <span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        run Called when user calls the :func:&#39;~start&#39; method.  Its primary task is to monitor if the child threads are active and report thread status, It also is responsible for signaling the termination of the ThreadManager once all children threads have died.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">monitor_threads</span><span class="p">:</span>
            <span class="n">logging</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Thread Monitoring disabled for Thread Manager&quot;</span><span class="p">)</span>

        <span class="c1"># This block of code periodically monitors the status of each child thread</span>
        <span class="k">while</span> <span class="bp">self</span><span class="o">.</span><span class="n">alive_count</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">alive_count</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">([</span><span class="n">t</span><span class="o">.</span><span class="n">isAlive</span><span class="p">()</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">periodic_threads</span><span class="p">])</span> <span class="o">+</span> <span class="nb">sum</span><span class="p">(</span>
                <span class="p">[</span><span class="n">t</span><span class="o">.</span><span class="n">isAlive</span><span class="p">()</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">onetime_threads</span><span class="p">]</span>
            <span class="p">)</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">monitor_threads</span><span class="p">:</span>
                <span class="n">logging</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
                    <span class="s2">&quot;Number of active child threads: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">alive_count</span><span class="p">)</span>
                <span class="p">)</span>
                <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">threading</span><span class="o">.</span><span class="n">enumerate</span><span class="p">():</span>
                    <span class="n">logging</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>

            <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">monitor_debug_period</span><span class="p">)</span></div>

    <span class="k">def</span> <span class="nf">stop_periodic_thread</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">thread_name</span><span class="p">):</span>
        <span class="c1"># This method stops a periodic thread with a given name</span>

        <span class="n">found</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">periodic_threads</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">t</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="n">thread_name</span><span class="p">:</span>
                <span class="n">t</span><span class="o">.</span><span class="n">stop_thread</span><span class="p">()</span>
                <span class="n">found</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">found</span><span class="p">:</span>
            <span class="n">logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span>
                <span class="s1">&#39;No periodic child thread with name &quot;&#39;</span>
                <span class="o">+</span> <span class="n">thread_name</span>
                <span class="o">+</span> <span class="s1">&#39;&quot; found. Unable to stop thread&#39;</span>
            <span class="p">)</span>

    <span class="k">def</span> <span class="nf">resume_periodic_thread</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">thread_name</span><span class="p">):</span>
        <span class="c1"># This method resumes a periodic thread with a given name</span>

        <span class="n">found</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">periodic_threads</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">t</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="n">thread_name</span><span class="p">:</span>
                <span class="n">t</span><span class="o">.</span><span class="n">resume_thread</span><span class="p">()</span>
                <span class="n">found</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">found</span><span class="p">:</span>
            <span class="n">logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span>
                <span class="s1">&#39;No periodic child thread with name &quot;&#39;</span>
                <span class="o">+</span> <span class="n">thread_name</span>
                <span class="o">+</span> <span class="s1">&#39;&quot; found. Unable to resume thread&#39;</span>
            <span class="p">)</span>

    <span class="k">def</span> <span class="nf">run_while_active</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># This method should only be called from the main thread in order</span>
        <span class="c1"># to avoid the program becoming unresponsive</span>

        <span class="k">while</span> <span class="bp">self</span><span class="o">.</span><span class="n">isAlive</span><span class="p">():</span>
            <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.1</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">set_monitor_debug_frequency</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">frequency</span><span class="p">):</span>
        <span class="c1"># Update monitor period</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">monitor_debug_period</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="n">frequency</span>

    <span class="k">def</span> <span class="nf">new_periodic</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">function</span><span class="p">,</span> <span class="n">thread_name</span><span class="p">,</span> <span class="n">frequency</span><span class="p">,</span> <span class="n">daemonic</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="o">*</span><span class="n">argv</span><span class="p">):</span>
        <span class="c1"># This function is a factory that generates a new periodic thread. Threads</span>
        <span class="c1"># should be set to daemonic to avoid the an unresponsive program (unless</span>
        <span class="c1"># you don&#39;t want the thread to end with the main thread dies).</span>

        <span class="c1"># Create new periodic thread</span>
        <span class="n">per_thread</span> <span class="o">=</span> <span class="n">PeriodicThread</span><span class="p">(</span><span class="n">function</span><span class="p">,</span> <span class="n">frequency</span><span class="p">,</span> <span class="o">*</span><span class="n">argv</span><span class="p">)</span>
        <span class="n">per_thread</span><span class="o">.</span><span class="n">setName</span><span class="p">(</span><span class="n">thread_name</span><span class="p">)</span>
        <span class="n">per_thread</span><span class="o">.</span><span class="n">daemon</span> <span class="o">=</span> <span class="n">daemonic</span>

        <span class="c1"># Add thread to global monitoring list</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">periodic_count</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">periodic_count</span> <span class="o">+</span> <span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">alive_count</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">alive_count</span> <span class="o">+</span> <span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">periodic_threads</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">per_thread</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">new_onetime</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">function</span><span class="p">,</span> <span class="n">thread_name</span><span class="p">,</span> <span class="n">daemonic</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="o">*</span><span class="n">argv</span><span class="p">):</span>
        <span class="c1"># This function is a factory that generates a new thread. Threads</span>
        <span class="c1"># should be set to daemonic to avoid the an unresponsive program (unless</span>
        <span class="c1"># you don&#39;t want the thread to end with the main thread dies).</span>

        <span class="c1"># Create new onetime thread</span>
        <span class="n">ot_thread</span> <span class="o">=</span> <span class="n">OnetimeThread</span><span class="p">(</span><span class="n">function</span><span class="p">,</span> <span class="o">*</span><span class="n">argv</span><span class="p">)</span>
        <span class="n">ot_thread</span><span class="o">.</span><span class="n">setName</span><span class="p">(</span><span class="n">thread_name</span><span class="p">)</span>
        <span class="n">ot_thread</span><span class="o">.</span><span class="n">daemon</span> <span class="o">=</span> <span class="n">daemonic</span>

        <span class="c1"># Add thread to global monitoring list</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">onetime_count</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">onetime_count</span> <span class="o">+</span> <span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">alive_count</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">alive_count</span> <span class="o">+</span> <span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">onetime_threads</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ot_thread</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">start_all</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># This method calls &quot;start()&quot; for each thread in the global monitoring lists</span>

        <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">periodic_threads</span><span class="p">:</span>
            <span class="n">t</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>

        <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">onetime_threads</span><span class="p">:</span>
            <span class="n">t</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">join_all</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># This method calls &quot;join()&quot; for each thread in the global monitoring lists</span>

        <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">periodic_threads</span><span class="p">:</span>
            <span class="n">t</span><span class="o">.</span><span class="n">join</span><span class="p">()</span>

        <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">onetime_threads</span><span class="p">:</span>
            <span class="n">t</span><span class="o">.</span><span class="n">join</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">start_by_name</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
        <span class="c1"># This method calls &quot;start()&quot; for a thread with a specific name</span>

        <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">periodic_threads</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">t</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="n">name</span><span class="p">:</span>
                <span class="n">t</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>

        <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">onetime_threads</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">t</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="n">name</span><span class="p">:</span>
                <span class="n">t</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">join_by_name</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
        <span class="c1"># This method calls &quot;join()&quot; for a thread with a specific name</span>

        <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">periodic_threads</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">t</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="n">name</span><span class="p">:</span>
                <span class="n">t</span><span class="o">.</span><span class="n">join</span><span class="p">()</span>

        <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">onetime_threads</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">t</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="n">name</span><span class="p">:</span>
                <span class="n">t</span><span class="o">.</span><span class="n">join</span><span class="p">()</span></div>


<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">This is a helper class that executes a target method in a new thread. It helps the ThreadManager create new threads.</span>

<span class="sd">CEI-LAB, Cornell University 2019</span>
<span class="sd">&quot;&quot;&quot;</span>


<div class="viewcode-block" id="OnetimeThread"><a class="viewcode-back" href="../../../_autosummary/robot.thread_manager.ThreadManager.OnetimeThread.html#robot.thread_manager.ThreadManager.OnetimeThread">[docs]</a><span class="k">class</span> <span class="nc">OnetimeThread</span><span class="p">(</span><span class="n">Thread</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">function</span><span class="p">,</span> <span class="o">*</span><span class="n">argv</span><span class="p">):</span>
        <span class="n">Thread</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">args</span> <span class="o">=</span> <span class="n">argv</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">function</span> <span class="o">=</span> <span class="n">function</span>

<div class="viewcode-block" id="OnetimeThread.run"><a class="viewcode-back" href="../../../_autosummary/robot.thread_manager.ThreadManager.OnetimeThread.html#robot.thread_manager.ThreadManager.OnetimeThread.run">[docs]</a>    <span class="k">def</span> <span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">function</span><span class="p">(</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">args</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="n">logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;OnetimeThread Error: &quot;</span><span class="p">)</span>
            <span class="n">logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">traceback</span><span class="o">.</span><span class="n">format_exc</span><span class="p">())</span></div></div>


<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">This is a helper class that periodically executes a target method in a new thread. It helps the ThreadManager create </span>
<span class="sd">new threads.</span>

<span class="sd">CEI-LAB, Cornell University 2019</span>
<span class="sd">&quot;&quot;&quot;</span>


<div class="viewcode-block" id="PeriodicThread"><a class="viewcode-back" href="../../../_autosummary/robot.thread_manager.ThreadManager.PeriodicThread.html#robot.thread_manager.ThreadManager.PeriodicThread">[docs]</a><span class="k">class</span> <span class="nc">PeriodicThread</span><span class="p">(</span><span class="n">Thread</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">function</span><span class="p">,</span> <span class="n">frequency</span><span class="p">,</span> <span class="o">*</span><span class="n">argv</span><span class="p">):</span>
        <span class="c1"># Call parent constructor</span>
        <span class="n">Thread</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

        <span class="c1"># Set parameters for periodic execution</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">frequency</span> <span class="o">=</span> <span class="n">frequency</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">period</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="n">frequency</span>

        <span class="c1"># Method and arguments</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">function</span> <span class="o">=</span> <span class="n">function</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">args</span> <span class="o">=</span> <span class="n">argv</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stop</span> <span class="o">=</span> <span class="kc">False</span>

<div class="viewcode-block" id="PeriodicThread.run"><a class="viewcode-back" href="../../../_autosummary/robot.thread_manager.ThreadManager.PeriodicThread.html#robot.thread_manager.ThreadManager.PeriodicThread.run">[docs]</a>    <span class="k">def</span> <span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">while</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">stop</span><span class="p">:</span>
            <span class="c1"># Time exicution of target function in order to determin remaining wait time</span>
            <span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">function</span><span class="p">(</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">args</span><span class="p">)</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="n">logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;PeriodicThread Error: &quot;</span><span class="p">)</span>
                <span class="n">logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">traceback</span><span class="o">.</span><span class="n">format_exc</span><span class="p">())</span>

            <span class="c1"># If execution time is greater than wait time, don&#39;t wait.</span>
            <span class="n">exicution_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_time</span>
            <span class="k">if</span> <span class="n">exicution_time</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">period</span><span class="p">)</span></div>

    <span class="k">def</span> <span class="nf">stop_thread</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stop</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="k">def</span> <span class="nf">resume_thread</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stop</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">run</span><span class="p">()</span></div>
</pre></div>

            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../../index.html">MarthaRobot  documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../../index.html" >Module code</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">robot.thread_manager.ThreadManager</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2023, CEI-Lab.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 7.0.1.
    </div>
  </body>
</html>